<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="utf-8" />
	</head>
	<style>
	.grid{

	}
	#unclicked {
	width: 50px;
	height: 50px;
	background: gray;
	}
	#clicked{
	width: 100px;
	height: 100px;
	background: white;
	}
	</style>
	<script src="jquery/jquery-1.11.1.min.js"></script> 
	<script type="text/javascript">





	$(document).ready(function(){  


		var n = 8
		//create grid 
		for (i=0; i<n; i++){
			$(".grid").append("<tr class='gridrow'></tr>")
		} 
		for (i=0;i<n;i++){
				$(".gridrow").append("<td id='unclicked'></td>")
		} 
		var gen_rows = function(x){ 
			var row = []
			for (i=0; i<x; i++){
				var o = {}
				o.is_visible = "false";
				o.category = "empty"; 
				o.number = 0;
				row.push(o)
			} 
			return row
		} 
		//create array for board
		//works 
		var init_board = function(x){
			var container = [];
			// var row = gen_rows()
			for (var i=0; i<x; i++){
				container.push(gen_rows(n))  
			}
			return container
				} 
	//board is created
		var seed_bomb= function(x){
			var seed_bomb_index = Math.floor(Math.random() * 7)
			return seed_bomb_index
		}
		var gen_bomb_coordinates=function(){ 
		 		var x = seed_bomb(n);
		 		var y = seed_bomb(n); 
				return [x, y]
		}
		console.log(gen_bomb_coordinates())
		var get_bomb_coordinates = function(){
			var bomb_coordinates = [];
			var num_bombs = 3
			for(var i=0; i<num_bombs; i++){
				bomb_coordinates.push(gen_bomb_coordinates())
			}  
			return bomb_coordinates
		}

		//refactor these two into single function
		// var add_bombs= function(){
		// 	var board = init_board(n);
		// 	//console.log(board)
		// 	var bomb_coordinates = get_bomb_coordinates()		
		// 	//console.log(num_bombs)
		// 	//console.log(bomb_coordinates)
		// 	var l = bomb_coordinates.length; 
		// 	for (i=0; i<l; i++){
		// 		var current = bomb_coordinates.pop()  
		// 		var x = current[0]; 
		// 		var y = current[1]; 
		// 		var index = board[x] 
		// 		var d = index[y] 
		// 		d["category"] = "bomb" 
		// 	}
		// 	return board
		// } 

		var gen_board_array = function(){
			var board = init_board(n)
			var bomb_coordinates = get_bomb_coordinates() 
			var l = bomb_coordinates.length 			
			for (i=0; i<l; i++){
				var current = bomb_coordinates.pop()  
				var x = current[0]; 
				var y = current[1];  
				board[x][y]["category"] = "bomb" 
					if(x > 0 && y<n){
						board[x-1][y+1]["number"]++
						console.log(board[x-1][y+1])
					}
					if (x>0 && y>0){
						board[x-1][y-1]["number"]++
						console.log(board[x-1][y-1])
					}
					if (y>0 && x<n){
						board[x+1][y-1]["number"]++
						console.log(board[x+1][y-1])
					}
					if (x<n && y<n){
						board[x+1][y+1]["number"]++
						console.log(board[x+1][y+1])
					}
					if (x<n){
						board[x+1][y]["number"]++
						console.log(board[x+1][y])
					}
					if (y<n){
						board[x][y+1]["number"]++
						console.log(board[x][y+1])
					}
					if (y>0){
						board[x][y-1]["number"]++
						console.log(board[x][y-1])
					}
					if (x>0){
						board[x-1][y]["number"]++
						console.log(board[x-1][y])	
					} 
				}
			return board
		}
		console.log(gen_board_array())

		var array_of_boards = []
  		if(array_of_boards.length<1){
  			array_of_boards.push(gen_board_array())
  			console.log("pushed array")
  		}
		var board = array_of_boards[0]
  		console.log(array_of_boards[0]) 
  		for (i=0; i<board.length; i++){
  			for (j=0; j<board[i].length; j++){
			console.log(board[i][j])
			console.log("i="+i+"j="+j)
			}
		}
		// event listener to get coordinates
  		$( "*", document.body ).click(function( event ) {
		var offset = $( this ).position();
		event.stopPropagation();
		$( "#result" ).text( this.tagName +
		    " coords ( " + offset.left + ", " + offset.top + " )" );
		var x = offset.left;
			  if (x===10){
			  	board_x = 0
			  }
			  if (x>10){
			  	board_x = (x-10)/54
			  }
			  var y = offset.top
			  if(y===52){
			  	var board_y =0
			  }
			  else{
			  	var board_y = (y-52)/54
			  } 

		  if(board[board_x][board_y]["category"]=="bomb"){
		  	$(this).text("X");
		  }
		  if(board[board_x][board_y]["category"]=="empty" && board[board_x][board_y]["number"]==0){
		  	$(this).text("empty");
		  }
		  if(board[board_x][board_y]["number"]>0){
		  	$(this).text(board[board_x][board_y]["number"]);
		  }
		  
		});
  		// map coordinates to board arrays
  		//show text if board
  		 


	}); 
	</script>
	<body>
	<p id="result">Click a square</p>
	<div id="board">
                <table class="grid">
                </table>
     </div>
	
	</body>
